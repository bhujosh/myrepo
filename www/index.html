<html>
	<head>
		<meta charset="utf-8" />
	        <meta name="format-detection" content="telephone=no" />
        	<meta name="msapplication-tap-highlight" content="no" />
	        <!-- WARNING: for iOS 7, remove the width=device-width and height=device-height attributes. See https://issues.apache.org/jira/browse/CB-4323 -->
        	<meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height, target-densitydpi=device-dpi" />
	        <link rel="stylesheet" type="text/css" href="css/index.css" />
	        <title>Game1: Fruit Basket</title>
    	</head>
    	<body>
		<script type="text/javascript" src="cordova.js"></script>
        	<script type="text/javascript" src="js/index.js"></script>
	   	<script type="text/javascript" src="js/phaser.min.js"></script>			
        	
		<h1>Fruit Basket</h1>
		<h2>Use arrow keys to move left or right</h2>
		<h2>Press ESC whenever you want to stop the game</h2>
    		<script type="text/javascript">
			var game = new Phaser.Game(800, 600, Phaser.AUTO, 'phaser-example', {preload: preload, create: create,update: update});
			var group1;
			var basket;
			var timer;
			var cursors;
			var sprite;
			var score=0;
			var scoreText;
			var esckey;
			var gameOverText;

			function preload() 
			{
				game.load.image('basket', 'images/basket3.png');
			    	game.load.spritesheet('fandi', 'images/fruitsinsects.png', 64, 64);		   	
				game.load.image('sky','images/starrysky.png');
			}
			function create()
			{
				game.physics.startSystem(Phaser.Physics.ARCADE);
				game.physics.arcade.checkCollision.down=false;

				//added for mobile screens
				this.scale.ScaleMode=Phaser.ScaleManager.USER_SCALE;
				this.scale.setResizeCallback(this.gameResized,this);
				//--********************--

				background=game.add.image(0,0,'sky');	
				cursors = game.input.keyboard.createCursorKeys();	
				spacekey=game.input.keyboard.addKey(Phaser.Keyboard.UP);
				esckey=game.input.keyboard.addKey(Phaser.Keyboard.ESC);
				basket=game.add.sprite(game.width/2,game.height-50,'basket');
				basket.scale.setTo(2,2);
				//added for mobile
				basket.inputEnabled=true;
				basket.input.enableDrag(false);
				//--****************--
				game.physics.arcade.enable(basket);

				basket.body.collideWorldBounds=true;
				basket.body.immovable=true;
				basket.body.allowGravity=false;
				
				group1=game.add.group();
				group1.enableBody=true;
				group1.physicsBodyType=Phaser.Physics.ARCADE;
				
				timer=game.time.create(false);
				timer.loop(2000,releaseObject,this);
				timer.start();
				
				scoreText = game.add.text(10, 10, 'Your score: 0', { font: "20px Arial", fill: "#000000", align: "left" });
				game.input.onTap.add(onTap,this);
			}	
			function onTap(pointer,doubleTap)
			{
				if(doubleTap)
				{
					reset();
					gameOverText=game.add.text(game.width/2-50, game.height/2,'Your Score is'+score + '\nThank you for playing FruitBasket', { font: "20px Arial", fill: "#000000", align: "left" });	
				}	
			}
			function gameResized()
			{
    				scale = Math.min(window.innerWidth / this.game.width, window.innerHeight / this.game.height);
 				var manager=Phaser.ScaleManager;	
				manager.setUserScale(scale, scale, 0, 0);
			}		
			function update()
			{
				game.physics.arcade.collide(basket,group1,collisionHandler,null,this);
			}
			function collisionHandler(basket,sprite)
			{
				if(sprite.frame<3)
					score=score+10;
				else
					score=score-15;
				scoreText.text='Your score: '+score;
				sprite.kill();
				sprite.destroy();
			}
			function releaseObject()
			{
				var rnum=game.rnd.between(0,5);
				sprite=group1.create(game.rnd.between(1,game.width),0,'fandi',rnum);
				sprite.body.collideWorldBounds=true;
				sprite.body.gravity.x=game.rnd.integerInRange(-50,50);
				sprite.body.gravity.y=100+Math.random()*100;
				sprite.body.bounce.setTo(0.9,0.9);
				
			}
		</script>
	</body>
</html>